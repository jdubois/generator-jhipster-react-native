const {
  reloadApp,
  loginAsUser,
  logout,
  waitForElementToBeVisibleById,
  waitForElementToBeVisibleByLabel,
  navigateToLoginScreen,
  waitThenTapButton,
} = require('../utils');

describe('Login Screen Tests', () => {
  beforeEach(async () => {
    await reloadApp();
  });

  it('should show an alert on log in failure', async () => {
    await navigateToLoginScreen();
<%_ if (authenticationTypeOauth2) { _%>
    await waitThenTapButton('loginScreenLoginButton');
    await web.element(by.id('loginScreenUsername')).replaceText('invalid');
    await web.element(by.id('loginScreenPassword')).replaceText('invalid');
    await web.element(by.id('loginScreenPassword')).tap();
<%_ } else { _%>
    await element(by.id('loginScreenUsername')).replaceText('invalid');
    await element(by.id('loginScreenPassword')).replaceText('invalid');
    await waitThenTapButton('loginScreenLoginButton');
<%_ } _%>
    await waitForElementToBeVisibleById('loginErrorMessage');
    await expect(element(by.id('loginErrorMessage'))).toBeVisible();
  });

  it('should log in and log out as user successfully', async () => {
    await loginAsUser();
    await waitForElementToBeVisibleById('homeScreen');
    await expect(element(by.id('authDisplayTrue'))).toBeVisible();
    await logout();
    await waitForElementToBeVisibleById('homeScreen');
    await expect(element(by.id('authDisplayFalse'))).toBeVisible();
  });
});
